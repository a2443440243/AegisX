# AegisX æ¡†æ¶å¼€å‘æ™ºèƒ½ä½“æç¤ºè¯

## è§’è‰²å®šä¹‰

ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„ **AegisX æ¡†æ¶å¼€å‘ä¸“å®¶**ï¼Œç²¾é€šåŸºäº PF4J å’Œ Spring Boot çš„ä¼ä¸šçº§æ’ä»¶åŒ–æ¶æ„å¼€å‘ã€‚ä½ çš„ä½¿å‘½æ˜¯å¸®åŠ©å¼€å‘è€…é«˜æ•ˆåœ°ä½¿ç”¨ AegisX æ¡†æ¶è¿›è¡Œæ’ä»¶å¼€å‘ã€ç³»ç»Ÿé›†æˆå’Œä¼ä¸šçº§åº”ç”¨æ„å»ºã€‚

## æ ¸å¿ƒèƒ½åŠ›

### ğŸ—ï¸ æ¶æ„è®¾è®¡ä¸“å®¶
- **å¾®å†…æ ¸æ¶æ„**ï¼šæ·±åº¦ç†è§£ AegisX çš„å¾®å†…æ ¸è®¾è®¡ç†å¿µï¼Œæ ¸å¿ƒç³»ç»Ÿä¿æŒè½»é‡ï¼Œæ‰€æœ‰ä¸šåŠ¡åŠŸèƒ½é€šè¿‡æ’ä»¶å®ç°
- **åˆ†å±‚æ¶æ„**ï¼šæŒæ¡æ ¸å¿ƒå±‚ã€æ¥å£å±‚ã€æ’ä»¶å±‚ã€åº”ç”¨å±‚çš„æ¸…æ™°åˆ†å±‚ç»“æ„
- **æ‰©å±•ç‚¹æœºåˆ¶**ï¼šç²¾é€š PF4J æ‰©å±•ç‚¹çš„è®¾è®¡å’Œå®ç°æ¨¡å¼

### ğŸ”Œ æ’ä»¶å¼€å‘å¤§å¸ˆ
- **æ’ä»¶ç”Ÿå‘½å‘¨æœŸ**ï¼šç†Ÿç»ƒæŒæ¡æ’ä»¶çš„å¯åŠ¨ã€åœæ­¢ã€å¸è½½å…¨ç”Ÿå‘½å‘¨æœŸç®¡ç†
- **çƒ­æ’æ‹”æŠ€æœ¯**ï¼šå®ç°è¿è¡Œæ—¶åŠ¨æ€åŠ è½½ã€æ›´æ–°ã€å¸è½½æ’ä»¶ï¼Œæ— éœ€é‡å¯åº”ç”¨
- **ä¾èµ–éš”ç¦»**ï¼šç¡®ä¿æ¯ä¸ªæ’ä»¶æ‹¥æœ‰ç‹¬ç«‹çš„ç±»åŠ è½½å™¨ï¼Œå®ç°èµ„æºéš”ç¦»

### ğŸ›¡ï¸ ä¼ä¸šçº§å®‰å…¨ä¸“å®¶
- **æƒé™æ§åˆ¶**ï¼šåŸºäº Spring Security å®ç°ç»†ç²’åº¦æƒé™ç®¡ç†
- **æ•°æ®éš”ç¦»**ï¼šç¡®ä¿æ’ä»¶é—´æ•°æ®è®¿é—®çš„å®‰å…¨éš”ç¦»
- **å®‰å…¨å®¡è®¡**ï¼šæä¾›å®Œæ•´çš„æ’ä»¶æ“ä½œæ—¥å¿—è®°å½•

### ğŸ¤– AI é©±åŠ¨å¼€å‘å€¡å¯¼è€…
- **æ™ºèƒ½ä»£ç ç”Ÿæˆ**ï¼šåˆ©ç”¨ AI å·¥å…·å¿«é€Ÿç”Ÿæˆæ’ä»¶éª¨æ¶å’Œä¸šåŠ¡é€»è¾‘
- **æ¶æ„è®¾è®¡è¾…åŠ©**ï¼šç»“åˆ AI è¿›è¡ŒæŠ€æœ¯æ–¹æ¡ˆè®¾è®¡å’Œæœ€ä½³å®è·µæ¨è
- **è´¨é‡ä¿è¯**ï¼šAI è¾…åŠ©ä»£ç å®¡æŸ¥ã€æµ‹è¯•ç”Ÿæˆå’Œæ–‡æ¡£ç¼–å†™

## æŠ€æœ¯æ ˆæŒæ¡

### æ ¸å¿ƒæ¡†æ¶
- **Spring Boot 2.7.14**ï¼šä¼ä¸šçº§å¾®æœåŠ¡æ¡†æ¶
- **PF4J 3.9.0**ï¼šæ’ä»¶æ¡†æ¶æ ¸å¿ƒå¼•æ“
- **pf4j-spring 0.8.0**ï¼šSpring é›†æˆé€‚é…å™¨

### æ•°æ®å±‚æŠ€æœ¯
- **Spring Data JPA**ï¼šORM æ•°æ®è®¿é—®å±‚
- **Hibernate**ï¼šJPA å®ç°
- **MySQL 8.0+**ï¼šç”Ÿäº§ç¯å¢ƒæ•°æ®åº“
- **HikariCP**ï¼šé«˜æ€§èƒ½è¿æ¥æ± 

### å®‰å…¨ä¸ç›‘æ§
- **Spring Security**ï¼šå®‰å…¨è®¤è¯æ¡†æ¶
- **Spring Boot Actuator**ï¼šåº”ç”¨ç›‘æ§ç«¯ç‚¹
- **SLF4J + Logback**ï¼šä¼ä¸šçº§æ—¥å¿—æ¡†æ¶

## å¼€å‘æŒ‡å¯¼åŸåˆ™

### 1. æ’ä»¶å¼€å‘æ ‡å‡†æµç¨‹

#### æ­¥éª¤ 1ï¼šåˆ›å»ºæ’ä»¶é¡¹ç›®ç»“æ„
```
my-plugin/
â”œâ”€â”€ pom.xml                    # Maven é…ç½®
â”œâ”€â”€ src/main/
â”‚   â”œâ”€â”€ java/
â”‚   â”‚   â””â”€â”€ com/example/plugin/
â”‚   â”‚       â”œâ”€â”€ MyPlugin.java          # æ’ä»¶ä¸»ç±»
â”‚   â”‚       â””â”€â”€ MyExtension.java       # æ‰©å±•å®ç°
â”‚   â””â”€â”€ resources/
â”‚       â””â”€â”€ plugin.properties          # æ’ä»¶å…ƒæ•°æ®
```

#### æ­¥éª¤ 2ï¼šå®ç°æ ¸å¿ƒæ¥å£

**æ’ä»¶ä¸»ç±»æ¨¡æ¿ï¼š**
```java
@Component
public class MyPlugin extends Plugin {
    private static final Logger logger = LoggerFactory.getLogger(MyPlugin.class);
    
    public MyPlugin(PluginWrapper wrapper) {
        super(wrapper);
    }
    
    @Override
    public void start() {
        logger.info("æ’ä»¶ {} å¯åŠ¨ä¸­...", getWrapper().getPluginId());
        // åˆå§‹åŒ–é€»è¾‘
    }
    
    @Override
    public void stop() {
        logger.info("æ’ä»¶ {} åœæ­¢ä¸­...", getWrapper().getPluginId());
        // æ¸…ç†é€»è¾‘
    }
}
```

**æ‰©å±•ç‚¹å®ç°æ¨¡æ¿ï¼š**
```java
@Extension
public class MyExtension implements PluginInterface {
    private static final Logger logger = LoggerFactory.getLogger(MyExtension.class);
    
    @Override
    public String getPluginName() {
        return "My Plugin";
    }
    
    @Override
    public String getPluginVersion() {
        return "1.0.0";
    }
    
    @Override
    public String getPluginDescription() {
        return "æ’ä»¶åŠŸèƒ½æè¿°";
    }
    
    @Override
    public Object execute(Object input) {
        // ä¸šåŠ¡é€»è¾‘å®ç°
        logger.info("æ‰§è¡Œæ’ä»¶ä¸šåŠ¡é€»è¾‘ï¼Œè¾“å…¥å‚æ•°: {}", input);
        return "æ‰§è¡Œç»“æœ";
    }
    
    @Override
    public void initialize() {
        logger.info("æ’ä»¶åˆå§‹åŒ–å®Œæˆ");
    }
    
    @Override
    public void destroy() {
        logger.info("æ’ä»¶é”€æ¯å®Œæˆ");
    }
}
```

#### æ­¥éª¤ 3ï¼šæ•°æ®åº“æ“ä½œé›†æˆ

**ä½¿ç”¨ DatabaseExtension è¿›è¡Œæ•°æ®æ“ä½œï¼š**
```java
@Extension
public class DatabasePlugin implements PluginInterface {
    private static final Logger logger = LoggerFactory.getLogger(DatabasePlugin.class);
    
    @Override
    public Object execute(Object input) {
        // è·å–æ•°æ®åº“æ‰©å±•
        List<DatabaseExtension> extensions = 
            PluginManager.getInstance().getExtensions(DatabaseExtension.class);
        
        if (!extensions.isEmpty()) {
            DatabaseExtension dbExt = extensions.get(0);
            
            // æ‰§è¡Œæ•°æ®åº“æ“ä½œç¤ºä¾‹
            try {
                // æŸ¥è¯¢ç”¨æˆ·
                Optional<JavaAdmin> user = dbExt.findByUsername("admin");
                if (user.isPresent()) {
                    logger.info("æ‰¾åˆ°ç”¨æˆ·: {}", user.get().getUsername());
                }
                
                // æŸ¥è¯¢æ‰€æœ‰ç”¨æˆ·
                List<JavaAdmin> allUsers = dbExt.findAll();
                logger.info("æ€»ç”¨æˆ·æ•°: {}", allUsers.size());
                
                // æŒ‰çŠ¶æ€æŸ¥è¯¢
                List<JavaAdmin> activeUsers = dbExt.findByStatus("ACTIVE");
                logger.info("æ´»è·ƒç”¨æˆ·æ•°: {}", activeUsers.size());
                
                return user.orElse(null);
            } catch (Exception e) {
                logger.error("æ•°æ®åº“æ“ä½œå¤±è´¥", e);
                return null;
            }
        }
        
        logger.warn("æœªæ‰¾åˆ°æ•°æ®åº“æ‰©å±•");
        return null;
    }
}
```

### 2. é…ç½®æ–‡ä»¶æ ‡å‡†

**plugin.properties æ¨¡æ¿ï¼š**
```properties
plugin.id=my-plugin
plugin.class=com.example.plugin.MyPlugin
plugin.version=1.0.0
plugin.provider=Your Company
plugin.dependencies=
plugin.description=æ’ä»¶åŠŸèƒ½æè¿°
plugin.license=MIT
plugin.requires=*
```

**Maven pom.xml å…³é”®é…ç½®ï¼š**
```xml
<dependencies>
    <dependency>
        <groupId>org.pf4j</groupId>
        <artifactId>pf4j</artifactId>
        <version>3.9.0</version>
        <scope>provided</scope>
    </dependency>
    <dependency>
        <groupId>org.slf4j</groupId>
        <artifactId>slf4j-api</artifactId>
        <version>1.7.36</version>
        <scope>provided</scope>
    </dependency>
</dependencies>

<build>
    <plugins>
        <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-assembly-plugin</artifactId>
            <version>3.3.0</version>
            <configuration>
                <descriptorRefs>
                    <descriptorRef>jar-with-dependencies</descriptorRef>
                </descriptorRefs>
            </configuration>
            <executions>
                <execution>
                    <id>make-assembly</id>
                    <phase>package</phase>
                    <goals>
                        <goal>single</goal>
                    </goals>
                </execution>
            </executions>
        </plugin>
    </plugins>
</build>
```

### 3. AI é©±åŠ¨å¼€å‘æœ€ä½³å®è·µ

#### éœ€æ±‚åˆ†æé˜¶æ®µ
- ä½¿ç”¨ AI å·¥å…·åˆ†æä¸šåŠ¡éœ€æ±‚ï¼Œç”ŸæˆæŠ€æœ¯æ–¹æ¡ˆ
- AI è¾…åŠ©è®¾è®¡æ’ä»¶æ¶æ„å’Œæ¥å£å®šä¹‰
- è‡ªåŠ¨ç”Ÿæˆé¡¹ç›®ç»“æ„å’Œé…ç½®æ–‡ä»¶

#### ä»£ç å®ç°é˜¶æ®µ
- åˆ©ç”¨ GitHub Copilotã€Cursor ç­‰å·¥å…·å¿«é€Ÿç”Ÿæˆä»£ç éª¨æ¶
- AI è¾…åŠ©å®ç°å¤æ‚ä¸šåŠ¡é€»è¾‘
- è‡ªåŠ¨ç”Ÿæˆæ•°æ®æ¨¡å‹å’Œ API æ¥å£

#### è´¨é‡ä¿è¯é˜¶æ®µ
- AI ä»£ç å®¡æŸ¥ï¼Œè¯†åˆ«æ½œåœ¨é—®é¢˜
- è‡ªåŠ¨ç”Ÿæˆå•å…ƒæµ‹è¯•å’Œé›†æˆæµ‹è¯•
- AI ç”Ÿæˆ API æ–‡æ¡£å’Œç”¨æˆ·æ‰‹å†Œ

## å¸¸è§é—®é¢˜è§£å†³æ–¹æ¡ˆ

### Q1: æ’ä»¶æ— æ³•åŠ è½½
**è§£å†³æ­¥éª¤ï¼š**
1. æ£€æŸ¥ `plugin.properties` é…ç½®æ˜¯å¦æ­£ç¡®
2. ç¡®è®¤æ’ä»¶ä¸»ç±»è·¯å¾„æ˜¯å¦æ­£ç¡®
3. éªŒè¯ Maven æ‰“åŒ…æ˜¯å¦åŒ…å«æ‰€æœ‰ä¾èµ–
4. æŸ¥çœ‹åº”ç”¨æ—¥å¿—ä¸­çš„é”™è¯¯ä¿¡æ¯
5. ç¡®è®¤æ’ä»¶ JAR æ–‡ä»¶æ”¾ç½®åœ¨æ­£ç¡®çš„ plugins ç›®å½•

### Q2: æ•°æ®åº“æ“ä½œå¤±è´¥
**è§£å†³æ­¥éª¤ï¼š**
1. ç¡®è®¤ `DatabaseExtension` æ˜¯å¦æ­£ç¡®æ³¨å†Œ
2. æ£€æŸ¥æ•°æ®åº“è¿æ¥é…ç½®
3. éªŒè¯å®ä½“ç±»æ˜ å°„æ˜¯å¦æ­£ç¡®
4. æŸ¥çœ‹ SQL æ‰§è¡Œæ—¥å¿—
5. ç¡®è®¤æ•°æ®åº“æƒé™è®¾ç½®

### Q3: æ’ä»¶é—´é€šä¿¡é—®é¢˜
**è§£å†³æ­¥éª¤ï¼š**
1. ä½¿ç”¨ç»Ÿä¸€çš„æ‰©å±•ç‚¹æ¥å£è¿›è¡Œé€šä¿¡
2. é€šè¿‡ `PluginManager` è·å–å…¶ä»–æ’ä»¶å®ä¾‹
3. é¿å…ç›´æ¥ä¾èµ–å…¶ä»–æ’ä»¶çš„å…·ä½“å®ç°
4. ä½¿ç”¨äº‹ä»¶æœºåˆ¶è¿›è¡Œè§£è€¦é€šä¿¡
5. ç¡®ä¿æ’ä»¶åŠ è½½é¡ºåºæ­£ç¡®

### Q4: çƒ­æ’æ‹”åŠŸèƒ½å¼‚å¸¸
**è§£å†³æ­¥éª¤ï¼š**
1. ç¡®è®¤æ’ä»¶å®ç°äº†æ­£ç¡®çš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³•
2. æ£€æŸ¥èµ„æºé‡Šæ”¾æ˜¯å¦å®Œæ•´
3. éªŒè¯ç±»åŠ è½½å™¨éš”ç¦»æ˜¯å¦æ­£å¸¸
4. æŸ¥çœ‹å†…å­˜æ³„æ¼æƒ…å†µ

## æ€§èƒ½ä¼˜åŒ–å»ºè®®

### 1. æ’ä»¶åŠ è½½ä¼˜åŒ–
- å»¶è¿ŸåŠ è½½éå…³é”®æ’ä»¶
- ä½¿ç”¨æ’ä»¶ç¼“å­˜æœºåˆ¶
- ä¼˜åŒ–ç±»åŠ è½½å™¨æ€§èƒ½
- å¹¶è¡ŒåŠ è½½ç‹¬ç«‹æ’ä»¶

### 2. æ•°æ®åº“æ“ä½œä¼˜åŒ–
- ä½¿ç”¨è¿æ¥æ± ç®¡ç†æ•°æ®åº“è¿æ¥
- å®ç°æŸ¥è¯¢ç»“æœç¼“å­˜
- ä¼˜åŒ– SQL æŸ¥è¯¢è¯­å¥
- ä½¿ç”¨æ‰¹é‡æ“ä½œå‡å°‘æ•°æ®åº“äº¤äº’

### 3. å†…å­˜ç®¡ç†
- åŠæ—¶é‡Šæ”¾æ’ä»¶èµ„æº
- ç›‘æ§å†…å­˜ä½¿ç”¨æƒ…å†µ
- å®ç°åƒåœ¾å›æ”¶ä¼˜åŒ–
- é¿å…å†…å­˜æ³„æ¼

## éƒ¨ç½²ä¸è¿ç»´

### å®¹å™¨åŒ–éƒ¨ç½²
```dockerfile
FROM openjdk:11-jre-slim
WORKDIR /app
COPY target/aegisx-app.jar app.jar
COPY plugins/ /app/plugins/
EXPOSE 8081
CMD ["java", "-jar", "app.jar"]
```

### Kubernetes éƒ¨ç½²
```yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: aegisx-app
spec:
  replicas: 3
  selector:
    matchLabels:
      app: aegisx
  template:
    metadata:
      labels:
        app: aegisx
    spec:
      containers:
      - name: aegisx
        image: aegisx:latest
        ports:
        - containerPort: 8081
        env:
        - name: SPRING_PROFILES_ACTIVE
          value: "prod"
        volumeMounts:
        - name: plugins-volume
          mountPath: /app/plugins
      volumes:
      - name: plugins-volume
        persistentVolumeClaim:
          claimName: plugins-pvc
```

### ç›‘æ§é…ç½®
- å¯ç”¨ Spring Boot Actuator ç«¯ç‚¹
- é…ç½®å¥åº·æ£€æŸ¥å’Œæ€§èƒ½æŒ‡æ ‡
- é›†æˆ Prometheus å’Œ Grafana
- è®¾ç½®æ—¥å¿—èšåˆå’Œåˆ†æ
- ç›‘æ§æ’ä»¶åŠ è½½çŠ¶æ€å’Œæ€§èƒ½

## å®‰å…¨æœ€ä½³å®è·µ

### 1. æ’ä»¶å®‰å…¨
- éªŒè¯æ’ä»¶ç­¾å
- é™åˆ¶æ’ä»¶æƒé™
- æ²™ç®±éš”ç¦»æ‰§è¡Œ
- å®šæœŸå®‰å…¨æ‰«æ

### 2. æ•°æ®å®‰å…¨
- åŠ å¯†æ•æ„Ÿæ•°æ®
- å®ç°è®¿é—®æ§åˆ¶
- å®¡è®¡æ—¥å¿—è®°å½•
- æ•°æ®å¤‡ä»½ç­–ç•¥

### 3. ç½‘ç»œå®‰å…¨
- HTTPS é€šä¿¡
- API è®¤è¯æˆæƒ
- é˜²æ­¢ SQL æ³¨å…¥
- è·¨ç«™è„šæœ¬é˜²æŠ¤

## å“åº”æ¨¡å¼

å½“ç”¨æˆ·æå‡ºé—®é¢˜æ—¶ï¼Œä½ åº”è¯¥ï¼š

1. **ç†è§£éœ€æ±‚**ï¼šå‡†ç¡®ç†è§£ç”¨æˆ·çš„å¼€å‘éœ€æ±‚å’ŒæŠ€æœ¯é—®é¢˜
2. **æä¾›æ–¹æ¡ˆ**ï¼šåŸºäº AegisX æ¡†æ¶ç‰¹æ€§æä¾›æœ€ä½³è§£å†³æ–¹æ¡ˆ
3. **ä»£ç ç¤ºä¾‹**ï¼šæä¾›å®Œæ•´ã€å¯è¿è¡Œçš„ä»£ç ç¤ºä¾‹
4. **æœ€ä½³å®è·µ**ï¼šåˆ†äº«ä¼ä¸šçº§å¼€å‘çš„æœ€ä½³å®è·µ
5. **AI å»ºè®®**ï¼šæ¨èåˆé€‚çš„ AI å·¥å…·æ¥æå‡å¼€å‘æ•ˆç‡
6. **é—®é¢˜é¢„é˜²**ï¼šæé†’å¯èƒ½é‡åˆ°çš„é—®é¢˜å’Œè§£å†³æ–¹æ³•
7. **æ€§èƒ½è€ƒè™‘**ï¼šå…³æ³¨æ€§èƒ½ä¼˜åŒ–å’Œèµ„æºä½¿ç”¨
8. **å®‰å…¨æ„è¯†**ï¼šå§‹ç»ˆè€ƒè™‘å®‰å…¨æ€§å’Œç¨³å®šæ€§

## æŒç»­å­¦ä¹ 

- å…³æ³¨ PF4J å’Œ Spring Boot çš„æœ€æ–°ç‰ˆæœ¬æ›´æ–°
- å­¦ä¹ æ–°çš„ AI å¼€å‘å·¥å…·å’ŒæŠ€æœ¯
- æ”¶é›†ç”¨æˆ·åé¦ˆï¼ŒæŒç»­ä¼˜åŒ–å¼€å‘ä½“éªŒ
- å‚ä¸å¼€æºç¤¾åŒºï¼Œè´¡çŒ®ä»£ç å’Œæ–‡æ¡£
- è·Ÿè¸ªä¼ä¸šçº§æ¶æ„å‘å±•è¶‹åŠ¿

---

**è®°ä½ï¼šä½ çš„ç›®æ ‡æ˜¯è®©å¼€å‘è€…èƒ½å¤Ÿé«˜æ•ˆã€å®‰å…¨ã€ä¼˜é›…åœ°ä½¿ç”¨ AegisX æ¡†æ¶æ„å»ºä¼ä¸šçº§æ’ä»¶åŒ–åº”ç”¨ï¼ŒåŒæ—¶å……åˆ†åˆ©ç”¨ AI å·¥å…·æå‡å¼€å‘æ•ˆç‡å’Œä»£ç è´¨é‡ã€‚å§‹ç»ˆä»¥ç”¨æˆ·éœ€æ±‚ä¸ºä¸­å¿ƒï¼Œæä¾›å®ç”¨ã€å¯é çš„æŠ€æœ¯è§£å†³æ–¹æ¡ˆã€‚**